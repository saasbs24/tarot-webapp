<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Выбор карт Таро</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #f5f5f5;
            margin: 0;
            padding: 0;
        }
        h1 {
            color: #333;
        }
        #cards {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
        }
        .card {
            width: 150px;
            height: 250px;
            perspective: 1000px;
            cursor: pointer;
        }
        .card-inner {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.6s;
        }
        .card.flipped .card-inner {
            transform: rotateY(180deg);
        }
        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
        }
        .card-front {
            transform: rotateY(180deg);
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            background-color: #4caf50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <h1>🎯 Выберите 3 карты Таро</h1>
    <div id="cards"></div>
    <button id="submitBtn" disabled>✅ Отправить выбранные карты</button>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        const allCards = [
            "Башня.jpg", "Верховная жрица.jpg", "Влюбленные.jpg", "Дьявол.jpg", "Звезда.jpg", 
            "Иерофант.jpg", "Император.jpg", "Императрица.jpg", "Колесница.jpg", "Колесо фортуны.jpg", 
            "Королева кубков.jpg", "Королева мечей.jpg", "Король жезлов.jpg", "Король кубков.jpg", "Король мечей.jpg", 
            "Луна.jpg", "Маг.jpg", "Мир.jpg", "Отшельник.jpg", "Паж жезлов.jpg", "Паж кубков.jpg", 
            "Паж мечей.jpg", "Паж пентаклей.jpg", "Повешенный.jpg", "Пятерка кубков.jpg", "Пятерка мечей.jpg", 
            "Рыцарь жезлов.jpg", "Рыцарь кубков.jpg", "Рыцарь мечей.jpg", "Рыцарь пентаклей.jpg", "Семерка жезлов.jpg", 
            "Семерка кубков.jpg", "Семерка мечей.jpg", "Семерка пентаклей.jpg", "Сила.jpg", "Смерть.jpg", 
            "Солнце.jpg", "Справедливость.jpg", "Суд.jpg", "Тройка жезлов.jpg", "Тройка кубков.jpg", 
            "Тройка мечей.jpg", "Туз жезлов.jpg", "Туз кубков.jpg", "Туз мечей.jpg", "Туз пентаклей.jpg", 
            "Умеренность.jpg", "Четверка жезлов.jpg", "Четверка кубков.jpg", "Четверка мечей.jpg", "Четверка пентаклей.jpg", 
            "Шестерка жезлов.jpg", "Шестерка кубков.jpg", "Шестерка мечей.jpg", "Шестерка пентаклей.jpg", "Шут.jpg"
        ];

        // Перемешивание массива карт (Fisher-Yates shuffle)
        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Выбираем случайные 5 карт
        const selectedCards = shuffle([...allCards]).slice(0, 5);

        const cardsContainer = document.getElementById("cards");
        const selected = [];

        // Создание карточек
        selectedCards.forEach(card => {
            const cardElement = document.createElement("div");
            cardElement.className = "card";
            cardElement.innerHTML = `
                <div class="card-inner" onclick="flipCard(this, '${card}')">
                    <div class="card-back">
                        <img src="cards/card_back.jpg" alt="Back" style="width: 100%; height: 100%;">
                    </div>
                    <div class="card-front">
                        <img src="cards/${card}" alt="${card}" style="width: 100%; height: 100%;">
                    </div>
                </div>
            `;
            cardsContainer.appendChild(cardElement);
        });

        // Функция для переворота карты
        window.flipCard = function (element, card) {
            const parent = element.parentElement;
            if (!parent.classList.contains("flipped")) {
                parent.classList.add("flipped");
                selected.push(card);
                if (selected.length === 3) {
                    document.getElementById("submitBtn").disabled = false;
                }
            }
        };

        // Отправка выбранных карт
        document.getElementById("submitBtn").addEventListener("click", () => {
            if (selected.length === 3) {
                tg.sendData(JSON.stringify(selected));
                tg.close();
            }
        });
    </script>
</body>
</html>
