<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Ð’Ñ‹Ð±Ð¾Ñ€ ÐºÐ°Ñ€Ñ‚ Ð¢Ð°Ñ€Ð¾</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #f5f5f5;
            margin: 0;
            padding: 0;
        }
        h1 {
            color: #333;
        }
        #cards {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        .card {
            width: 120px;
            height: 200px;
            perspective: 1000px;
            cursor: pointer;
            position: relative;
            transform-origin: center;
            animation: spin 6s linear infinite;
        }
        .card img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .selected-cards {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            background-color: #4caf50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 20px;
        }
        button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <h1>ðŸŽ¯ Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ 3 ÐºÐ°Ñ€Ñ‚Ñ‹ Ð¢Ð°Ñ€Ð¾</h1>
    <div id="cards"></div>
    <div id="selectedCards" class="selected-cards"></div>
    <button id="submitBtn" disabled>âœ… ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ñ‹Ðµ ÐºÐ°Ñ€Ñ‚Ñ‹</button>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const tg = window.Telegram.WebApp;
            tg.expand();
            
            const params = new URLSearchParams(window.location.search);
            let user_id = params.get("user_id") || (tg.initDataUnsafe?.user?.id || null);

            if (!user_id) {
                console.error("âŒ ÐžÑˆÐ¸Ð±ÐºÐ°: user_id Ð½Ðµ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½!");
                alert("ÐžÑˆÐ¸Ð±ÐºÐ°: WebApp Ð½Ðµ ÑÐ¼Ð¾Ð³ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð²Ð°Ñˆ user_id!");
                return;
            }

            const allCards = [
				"Ð¨ÑƒÑ‚.jpg", "ÐœÐ°Ð³.jpg", "Ð’ÐµÑ€Ñ…Ð¾Ð²Ð½Ð°Ñ Ð¶Ñ€Ð¸Ñ†Ð°.jpg", "Ð˜Ð¼Ð¿ÐµÑ€Ð°Ñ‚Ñ€Ð¸Ñ†Ð°.jpg", "Ð˜Ð¼Ð¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€.jpg", "Ð˜ÐµÑ€Ð¾Ñ„Ð°Ð½Ñ‚.jpg", 
				"Ð’Ð»ÑŽÐ±Ð»ÐµÐ½Ð½Ñ‹Ðµ.jpg", "ÐšÐ¾Ð»ÐµÑÐ½Ð¸Ñ†Ð°.jpg", "Ð¡Ð¸Ð»Ð°.jpg", "ÐžÑ‚ÑˆÐµÐ»ÑŒÐ½Ð¸Ðº.jpg", "ÐšÐ¾Ð»ÐµÑÐ¾ Ñ„Ð¾Ñ€Ñ‚ÑƒÐ½Ñ‹.jpg", "Ð¡Ð¿Ñ€Ð°Ð²ÐµÐ´Ð»Ð¸Ð²Ð¾ÑÑ‚ÑŒ.jpg",
				"ÐŸÐ¾Ð²ÐµÑˆÐµÐ½Ð½Ñ‹Ð¹.jpg", "Ð¡Ð¼ÐµÑ€Ñ‚ÑŒ.jpg", "Ð£Ð¼ÐµÑ€ÐµÐ½Ð½Ð¾ÑÑ‚ÑŒ.jpg", "Ð”ÑŒÑÐ²Ð¾Ð».jpg", "Ð‘Ð°ÑˆÐ½Ñ.jpg", "Ð—Ð²ÐµÐ·Ð´Ð°.jpg", 
				"Ð›ÑƒÐ½Ð°.jpg", "Ð¡Ð¾Ð»Ð½Ñ†Ðµ.jpg", "Ð¡ÑƒÐ´.jpg", "ÐœÐ¸Ñ€.jpg",
				"Ð¢ÑƒÐ· Ð¶ÐµÐ·Ð»Ð¾Ð².jpg", "Ð”Ð²Ð¾Ð¹ÐºÐ° Ð¶ÐµÐ·Ð»Ð¾Ð².jpg", "Ð¢Ñ€Ð¾Ð¹ÐºÐ° Ð¶ÐµÐ·Ð»Ð¾Ð².jpg", "Ð§ÐµÑ‚Ð²ÐµÑ€ÐºÐ° Ð¶ÐµÐ·Ð»Ð¾Ð².jpg", "ÐŸÑÑ‚ÐµÑ€ÐºÐ° Ð¶ÐµÐ·Ð»Ð¾Ð².jpg",
				"Ð¨ÐµÑÑ‚ÐµÑ€ÐºÐ° Ð¶ÐµÐ·Ð»Ð¾Ð².jpg", "Ð¡ÐµÐ¼ÐµÑ€ÐºÐ° Ð¶ÐµÐ·Ð»Ð¾Ð².jpg", "Ð’Ð¾ÑÑŒÐ¼ÐµÑ€ÐºÐ° Ð¶ÐµÐ·Ð»Ð¾Ð².jpg", "Ð”ÐµÐ²ÑÑ‚ÐºÐ° Ð¶ÐµÐ·Ð»Ð¾Ð².jpg", "Ð”ÐµÑÑÑ‚ÐºÐ° Ð¶ÐµÐ·Ð»Ð¾Ð².jpg",
				"ÐŸÐ°Ð¶ Ð¶ÐµÐ·Ð»Ð¾Ð².jpg", "Ð Ñ‹Ñ†Ð°Ñ€ÑŒ Ð¶ÐµÐ·Ð»Ð¾Ð².jpg", "ÐšÐ¾Ñ€Ð¾Ð»ÐµÐ²Ð° Ð¶ÐµÐ·Ð»Ð¾Ð².jpg", "ÐšÐ¾Ñ€Ð¾Ð»ÑŒ Ð¶ÐµÐ·Ð»Ð¾Ð².jpg",
				"Ð¢ÑƒÐ· ÐºÑƒÐ±ÐºÐ¾Ð².jpg", "Ð”Ð²Ð¾Ð¹ÐºÐ° ÐºÑƒÐ±ÐºÐ¾Ð².jpg", "Ð¢Ñ€Ð¾Ð¹ÐºÐ° ÐºÑƒÐ±ÐºÐ¾Ð².jpg", "Ð§ÐµÑ‚Ð²ÐµÑ€ÐºÐ° ÐºÑƒÐ±ÐºÐ¾Ð².jpg", "ÐŸÑÑ‚ÐµÑ€ÐºÐ° ÐºÑƒÐ±ÐºÐ¾Ð².jpg",
				"Ð¨ÐµÑÑ‚ÐµÑ€ÐºÐ° ÐºÑƒÐ±ÐºÐ¾Ð².jpg", "Ð¡ÐµÐ¼ÐµÑ€ÐºÐ° ÐºÑƒÐ±ÐºÐ¾Ð².jpg", "Ð’Ð¾ÑÑŒÐ¼ÐµÑ€ÐºÐ° ÐºÑƒÐ±ÐºÐ¾Ð².jpg", "Ð”ÐµÐ²ÑÑ‚ÐºÐ° ÐºÑƒÐ±ÐºÐ¾Ð².jpg", "Ð”ÐµÑÑÑ‚ÐºÐ° ÐºÑƒÐ±ÐºÐ¾Ð².jpg",
				"ÐŸÐ°Ð¶ ÐºÑƒÐ±ÐºÐ¾Ð².jpg", "Ð Ñ‹Ñ†Ð°Ñ€ÑŒ ÐºÑƒÐ±ÐºÐ¾Ð².jpg", "ÐšÐ¾Ñ€Ð¾Ð»ÐµÐ²Ð° ÐºÑƒÐ±ÐºÐ¾Ð².jpg", "ÐšÐ¾Ñ€Ð¾Ð»ÑŒ ÐºÑƒÐ±ÐºÐ¾Ð².jpg",
				"Ð¢ÑƒÐ· Ð¼ÐµÑ‡ÐµÐ¹.jpg", "Ð”Ð²Ð¾Ð¹ÐºÐ° Ð¼ÐµÑ‡ÐµÐ¹.jpg", "Ð¢Ñ€Ð¾Ð¹ÐºÐ° Ð¼ÐµÑ‡ÐµÐ¹.jpg", "Ð§ÐµÑ‚Ð²ÐµÑ€ÐºÐ° Ð¼ÐµÑ‡ÐµÐ¹.jpg", "ÐŸÑÑ‚ÐµÑ€ÐºÐ° Ð¼ÐµÑ‡ÐµÐ¹.jpg",
				"Ð¨ÐµÑÑ‚ÐµÑ€ÐºÐ° Ð¼ÐµÑ‡ÐµÐ¹.jpg", "Ð¡ÐµÐ¼ÐµÑ€ÐºÐ° Ð¼ÐµÑ‡ÐµÐ¹.jpg", "Ð’Ð¾ÑÑŒÐ¼ÐµÑ€ÐºÐ° Ð¼ÐµÑ‡ÐµÐ¹.jpg", "Ð”ÐµÐ²ÑÑ‚ÐºÐ° Ð¼ÐµÑ‡ÐµÐ¹.jpg", "Ð”ÐµÑÑÑ‚ÐºÐ° Ð¼ÐµÑ‡ÐµÐ¹.jpg",
				"ÐŸÐ°Ð¶ Ð¼ÐµÑ‡ÐµÐ¹.jpg", "Ð Ñ‹Ñ†Ð°Ñ€ÑŒ Ð¼ÐµÑ‡ÐµÐ¹.jpg", "ÐšÐ¾Ñ€Ð¾Ð»ÐµÐ²Ð° Ð¼ÐµÑ‡ÐµÐ¹.jpg", "ÐšÐ¾Ñ€Ð¾Ð»ÑŒ Ð¼ÐµÑ‡ÐµÐ¹.jpg",
				"Ð¢ÑƒÐ· Ð¿ÐµÐ½Ñ‚Ð°ÐºÐ»ÐµÐ¹.jpg", "Ð”Ð²Ð¾Ð¹ÐºÐ° Ð¿ÐµÐ½Ñ‚Ð°ÐºÐ»ÐµÐ¹.jpg", "Ð¢Ñ€Ð¾Ð¹ÐºÐ° Ð¿ÐµÐ½Ñ‚Ð°ÐºÐ»ÐµÐ¹.jpg", "Ð§ÐµÑ‚Ð²ÐµÑ€ÐºÐ° Ð¿ÐµÐ½Ñ‚Ð°ÐºÐ»ÐµÐ¹.jpg", "ÐŸÑÑ‚ÐµÑ€ÐºÐ° Ð¿ÐµÐ½Ñ‚Ð°ÐºÐ»ÐµÐ¹.jpg",
				"Ð¨ÐµÑÑ‚ÐµÑ€ÐºÐ° Ð¿ÐµÐ½Ñ‚Ð°ÐºÐ»ÐµÐ¹.jpg", "Ð¡ÐµÐ¼ÐµÑ€ÐºÐ° Ð¿ÐµÐ½Ñ‚Ð°ÐºÐ»ÐµÐ¹.jpg", "Ð’Ð¾ÑÑŒÐ¼ÐµÑ€ÐºÐ° Ð¿ÐµÐ½Ñ‚Ð°ÐºÐ»ÐµÐ¹.jpg", "Ð”ÐµÐ²ÑÑ‚ÐºÐ° Ð¿ÐµÐ½Ñ‚Ð°ÐºÐ»ÐµÐ¹.jpg", "Ð”ÐµÑÑÑ‚ÐºÐ° Ð¿ÐµÐ½Ñ‚Ð°ÐºÐ»ÐµÐ¹.jpg",
				"ÐŸÐ°Ð¶ Ð¿ÐµÐ½Ñ‚Ð°ÐºÐ»ÐµÐ¹.jpg", "Ð Ñ‹Ñ†Ð°Ñ€ÑŒ Ð¿ÐµÐ½Ñ‚Ð°ÐºÐ»ÐµÐ¹.jpg", "ÐšÐ¾Ñ€Ð¾Ð»ÐµÐ²Ð° Ð¿ÐµÐ½Ñ‚Ð°ÐºÐ»ÐµÐ¹.jpg", "ÐšÐ¾Ñ€Ð¾Ð»ÑŒ Ð¿ÐµÐ½Ñ‚Ð°ÐºÐ»ÐµÐ¹.jpg"
			];
            
            function shuffle(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
                return array;
            }

            const availableCards = shuffle([...allCards]).slice(0, 5);
            const cardsContainer = document.getElementById("cards");
            const selectedCardsContainer = document.getElementById("selectedCards");
            let selected = [];

            availableCards.forEach(card => {
                const cardElement = document.createElement("div");
                cardElement.className = "card";
                cardElement.innerHTML = `<img src="cards/${card}" alt="${card}">`;
                cardElement.addEventListener("click", function () {
                    if (selected.length < 3 && !selected.includes(card)) {
                        selected.push(card);
                        cardElement.classList.add("selected");
                    }
                    if (selected.length === 3) {
                        finalizeSelection();
                    }
                });
                cardsContainer.appendChild(cardElement);
            });

            function finalizeSelection() {
                cardsContainer.innerHTML = "";
                selectedCardsContainer.innerHTML = "";
                selected.forEach(card => {
                    const selectedCard = document.createElement("div");
                    selectedCard.className = "card";
                    selectedCard.innerHTML = `<img src="cards/${card}" alt="${card}">`;
                    selectedCardsContainer.appendChild(selectedCard);
                });
                document.getElementById("submitBtn").disabled = false;
            }
            
            document.getElementById("submitBtn").addEventListener("click", () => {
                if (selected.length === 3) {
                    console.log("ðŸ“¤ ÐžÑ‚Ð¿Ñ€Ð°Ð²ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð² Telegram:", selected);
                    const payload = JSON.stringify({ user_id, cards: selected });
                    tg.sendData(payload);
                    setTimeout(() => {
                        tg.close();
                    }, 1000);
                }
            });
        });
    </script>
</body>
</html>

